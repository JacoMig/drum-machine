(this["webpackJsonpdrum-machine"]=this["webpackJsonpdrum-machine"]||[]).push([[0],{10:function(e){e.exports=JSON.parse('{"kick":{"url":"/samples/kick.wav"},"hihat":{"url":"/samples/hihat.wav"},"openhihat":{"url":"/samples/openhihat.wav"},"snare":{"url":"/samples/snare.wav"}}')},22:function(e,t,n){e.exports=n(41)},27:function(e,t,n){},28:function(e,t,n){},30:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(13),u=n.n(r),s=(n(27),n(2)),o=(n(28),n(3)),l=n(1),i=n(4),m=n.n(i),f=n(5),b=n(6),j=(n(29),n(14)),d=n(15),O=n(21),v=n(20);n(30);var p=function(){return"undefined"!==typeof window.ontouchstart},g=function(e){Object(O.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(j.a)(this,n),(a=t.call(this,e)).startDrag=function(e){e.preventDefault();var t=e.target.getBoundingClientRect(),n={x:t.left+t.width/2,y:t.top+t.height/2},c=function(e){p()?a.currentDeg=a.getDeg(e.touches[0].clientX,e.touches[0].clientY,n):a.currentDeg=a.getDeg(e.clientX,e.clientY,n),console.log(e.touches[0].clientX),a.currentDeg===a.startAngle&&a.currentDeg--;var t=Math.floor(a.convertRange(a.startAngle,a.endAngle,a.props.min,a.props.max,a.currentDeg));a.setState({deg:a.currentDeg}),a.props.onChange(t)};p()?(document.addEventListener("touchmove",c),document.addEventListener("touchend",(function(e){document.removeEventListener("touchmove",c)}))):(document.addEventListener("mousemove",c),document.addEventListener("mouseup",(function(e){document.removeEventListener("mousemove",c)})))},a.getDeg=function(e,t,n){var c=e-n.x,r=t-n.y,u=180*Math.atan(r/c)/Math.PI;return u+=c<0&&r>=0||c<0&&r<0?90:270,Math.min(Math.max(a.startAngle,u),a.endAngle)},a.convertRange=function(e,t,n,a,c){return(c-e)*(a-n)/(t-e)+n},a.renderTicks=function(){for(var e=[],t=a.fullAngle/a.props.numTicks,n=a.margin+a.props.size/2,c=a.startAngle;c<=a.endAngle;c+=t){var r={deg:c,tickStyle:{height:n+10,left:n-1,top:n+2,transform:"rotate("+c+"deg)",transformOrigin:"top"}};e.push(r)}return e},a.dcpy=function(e){return JSON.parse(JSON.stringify(e))},a.fullAngle=e.degrees,a.startAngle=(360-e.degrees)/2,a.endAngle=a.startAngle+e.degrees,a.margin=.15*e.size,a.currentDeg=Math.floor(a.convertRange(e.min,e.max,a.startAngle,a.endAngle,e.value)),a.state={deg:a.currentDeg},a}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t={width:this.props.size,height:this.props.size},n=this.dcpy(t),a=this.dcpy(t);return a.margin=this.margin,this.props.color&&(a.backgroundImage="radial-gradient(100% 70%,hsl(210, "+this.currentDeg+"%, "+this.currentDeg/5+"%),hsl("+100*Math.random()+",20%,"+this.currentDeg/36+"%))"),n.transform="rotate("+this.state.deg+"deg)",c.a.createElement("div",{className:"knob",style:t},c.a.createElement("div",{className:"ticks"},this.props.numTicks?this.renderTicks().map((function(t,n){return c.a.createElement("div",{key:n,className:"tick"+(t.deg<=e.currentDeg?" active":""),style:t.tickStyle})})):null),c.a.createElement("div",{className:"knob outer",style:a,onTouchStart:this.startDrag,onMouseDown:this.startDrag},c.a.createElement("div",{className:"knob inner",style:n},c.a.createElement("div",{className:"grip"}))))}}]),n}(c.a.Component);function E(){var e=Object(f.a)(["\n  font-size: 25px;\n  text-align: left;\n  color: black;\n  padding: 5px;\n  max-width: 60px;\n"]);return E=function(){return e},e}var h=b.a.input(E()),y=function(e){var t=e.playStop,n=e.setPlayStop,r=e.setBpm,u=e.bpm,s=e.volume,o=e.setVolume,l=e.minVolume;return Object(a.useEffect)((function(){return window.addEventListener("keydown",(function(e){"Space"===e.code&&n()})),function(){window.removeEventListener("keydown",(function(e){"Space"===e.code&&n()}))}}),[]),c.a.createElement("div",{className:"controls"},c.a.createElement("button",{onClick:n},t?c.a.createElement("i",{className:"fa fa-pause-circle-o"}):c.a.createElement("i",{className:"fa fa-play-circle-o"})),c.a.createElement("div",{className:"volume-controller"},c.a.createElement("label",null,"Volume"),c.a.createElement(g,{numTicks:10,degrees:220,min:0,max:64,value:s,size:35,onChange:function(e){return o(l+e)}})),c.a.createElement("div",{className:"bpm-controller"},c.a.createElement("label",null,"Bpm"),c.a.createElement(h,{type:"number",value:u,min:50,max:220,name:"bpm",onChange:function(e){return r(e.target.value)}})))},k=n(9),w=n.n(k),S=n(19);n(34),n(35),n(40);function N(){var e=Object(f.a)(["\n    background: white;\n    position: relative;\n"]);return N=function(){return e},e}b.a.select(N());var x=function(e){var t=e.fxName,n=e.setFx,r=Object(a.useState)(0),u=Object(s.a)(r,2),i=u[0],m=u[1],f=Object(a.useRef)(i);f.current=i;return Object(a.useEffect)((function(){m(0),n((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t,-80+f.current))}))}),[]),Object(a.useEffect)((function(){})),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,c.a.createElement("span",null,t),c.a.createElement(g,{numTicks:10,degrees:220,min:0,max:80,value:i,size:35,onChange:function(e){return function(e){m(-80+e),n((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t,f.current))}))}(e)}})))};function T(){var e=Object(f.a)(["\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    justify-content: space-around;\n"]);return T=function(){return e},e}var D=b.a.div(T()),C=function(e){var t=e.mute,n=e.setMute,a=(e.selected,e.toggleInstrument);return c.a.createElement(D,null,c.a.createElement("button",{onClick:function(){return n((function(e){return!e}))},className:"button-mute ".concat(t?"mute":"")},"M"),c.a.createElement("button",{onClick:a,className:"select-button"}))},M={delay:{tone:new m.a.FeedbackDelay({delayTime:-.1,feedback:-.1}),color:"darkorange",params:{delayTime:0,feedback:0}},phaser:{tone:new m.a.Phaser({frequency:0,octaves:0,baseFrequency:500}),color:"brown",params:{frequency:0,octaves:0}},bitCrusher:{tone:new m.a.BitCrusher({bits:0}),color:"aqua",params:{bits:0}}},F=function(e){var t=e.buffer,n=e.name,r=e.setBuffers,u=e.toggleInstrument,i=e.selected,f=Object(a.useState)(15),b=Object(s.a)(f,2),j=b[0],d=b[1],O=Object(a.useState)(!1),v=Object(s.a)(O,2),p=v[0],E=v[1],h=Object(a.useState)(),y=Object(s.a)(h,2),k=y[0],N=y[1],T=Object(a.useState)(),D=Object(s.a)(T,2),F=D[0],A=D[1],z=Object(a.useState)({}),B=Object(s.a)(z,2),R=B[0],q=B[1],X=Object(a.useState)({}),I=Object(s.a)(X,2),P=I[0],L=I[1],J=Object(a.useRef)(k);function V(){return(V=Object(S.a)(w.a.mark((function e(){var a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(new m.a.Channel({volume:-2}).toMaster());case 2:J.current&&(J.current.volume.value=-1*j),Object.keys(M).map((function(e){L((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(o.a)({},e,0))})),q((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(o.a)({},e+n,J.current.send(e,-1/0)))}))})),a=new m.a.Buffer("/drum-machine"+t,(function(){A(new m.a.Player(a.get()).connect(J.current))}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}J.current=k,Object(a.useEffect)((function(){!function(){V.apply(this,arguments)}()}),[]),Object(a.useEffect)((function(){r((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},n,F))}))}),[F]);return Object(a.useEffect)((function(){k&&(k.volume.value=p?-100:-1*(30-j))}),[j]),Object(a.useEffect)((function(){k&&(p?k.mute=p:k.volume.value=-1*(30-j))}),[p]),Object(a.useEffect)((function(){Object.keys(P).map((function(e){R[e+n]&&(R[e+n].gain.value=P[e])}))}),[P]),c.a.createElement("div",{className:"instrument ".concat(i?"selected":"")},c.a.createElement("div",{className:"".concat(n)},c.a.createElement("p",{className:"name"},n),c.a.createElement("div",{className:"volume-knob"},c.a.createElement(g,{numTicks:10,degrees:220,min:0,max:30,value:j,size:35,onChange:function(e){return function(e){d(e)}(e)}})),Object.keys(P).length>0&&c.a.createElement("div",{className:"sender"},Object.keys(P).map((function(e){return c.a.createElement(x,{key:e,fxName:e,setFx:L})}))),c.a.createElement(C,{setMute:E,mute:p,selected:i,toggleInstrument:function(){return u(n)}})))},A=function(e){var t=e.samples,n=e.setBuffers,a=e.toggleInstrument,r=e.currentInstrument;return c.a.createElement("div",{className:"instrument-rack"},Object.keys(t).map((function(e){return c.a.createElement(F,{key:e,name:e,buffer:t[e].url,setBuffers:n,toggleInstrument:a,selected:e===r})})))},z=n(10),B=function(e){var t=e.steps,n=e.currentStep,a=e.toggleStep,r=e.name;return c.a.createElement("div",{className:"steps-line"},t&&t.length>0&&t.map((function(e,t){return c.a.createElement("div",{key:r+"-"+t,className:"step ".concat(e?"active":""," ").concat(n===t?"current":""),onMouseDown:function(){return a(t)}})})))};function R(){var e=Object(f.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: space-around;\n"]);return R=function(){return e},e}function q(){var e=Object(f.a)([""]);return q=function(){return e},e}var X=b.a.div(q()),I=b.a.div(R()),P=function(e){var t=e.FX,n=e.params,r=e.setParams,u=Object(a.useState)(Object.keys(t)[0]),i=Object(s.a)(u,2),m=i[0],f=(i[1],Object(a.useRef)(n));f.current=n,Object(a.useEffect)((function(){return m&&(t[m].feedback.value=n.feedback,t[m].delayTime.value=n.delayTime,t[m].receive(m).toMaster(),console.log("Delay",m)),console.log(m,"mount"),console.log(m+" params",n),function(){console.log(m,"unmount")}}),[]);var b=function(e,n){switch(n){case"feedback":r((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(o.a)({},m,Object(l.a)(Object(l.a)({},t[m]),{},Object(o.a)({},n,e/10))))})),t[m].feedback.value=f.current[n];break;case"delayTime":r((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(o.a)({},m,Object(l.a)(Object(l.a)({},t[m]),{},Object(o.a)({},n,(a=e/10.5,c=2,Number(Math.round(a+"e"+c)+"e-"+c))))));var a,c})),t[m].delayTime.value=1-f.current[n]}};return c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{className:"fx-wrapper"},c.a.createElement("span",null,m),c.a.createElement("span",{onClick:function(){return null}},"X"),c.a.createElement(I,null,c.a.createElement("div",null,c.a.createElement("h4",null,"Feedback"),c.a.createElement(g,{numTicks:8,degrees:220,min:0,max:10,value:10*n.feedback,size:35,onChange:function(e){return b(e,"feedback")}})),c.a.createElement("div",null,c.a.createElement("h4",null,"Delay Time"),c.a.createElement(g,{numTicks:8,degrees:220,min:0,max:10,value:10.5*n.delayTime,size:35,onChange:function(e){return b(e,"delayTime")}})))))};function L(){var e=Object(f.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: space-around;\n"]);return L=function(){return e},e}var J=b.a.div(L()),V=function(e){var t=e.FX,n=e.params,r=e.setParams,u=Object(a.useState)(Object.keys(t)[0]),i=Object(s.a)(u,2),m=i[0];i[1];Object(a.useEffect)((function(){return m&&(t[m].set("frequency",n.frequency),t[m].set("octaves",n.octaves),t[m].receive(m).toMaster()),console.log(m,"mount"),console.log(m+" params",n),function(){console.log(m,"unmount")}}),[]);var f=function(e,a){switch(a){case"frequency":r((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(o.a)({},m,Object(l.a)(Object(l.a)({},t[m]),{},Object(o.a)({},a,e/10))))})),t[m].set("frequency",n[a]);break;case"octaves":r((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(o.a)({},m,Object(l.a)(Object(l.a)({},t[m]),{},Object(o.a)({},a,e))))})),t[m].set("octaves",n[a])}};return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"fx-wrapper"},c.a.createElement("span",null,m),c.a.createElement("span",{onClick:function(){return null}},"X"),c.a.createElement(J,null,c.a.createElement("div",null,c.a.createElement("h4",null,"Frequency"),c.a.createElement(g,{numTicks:8,degrees:220,min:0,max:4e3,value:10*n.frequency,size:35,onChange:function(e){return f(e,"frequency")}})),c.a.createElement("div",null,c.a.createElement("h4",null,"Octaves"),c.a.createElement(g,{numTicks:8,degrees:220,min:0,max:8,value:n.octaves,size:35,onChange:function(e){return f(e,"octaves")}})))))};function W(){var e=Object(f.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: space-around;\n"]);return W=function(){return e},e}var Y=b.a.div(W()),$=function(e){var t=e.FX,n=e.params,r=e.setParams,u=Object(a.useState)(Object.keys(t)[0]),i=Object(s.a)(u,2),m=i[0],f=(i[1],Object(a.useRef)(n));f.current=n,Object(a.useEffect)((function(){return m&&(t[m].bits=8-n.bits,t[m].receive(m).toMaster()),console.log(m,"mount"),console.log(m+" params",n),function(){console.log(m,"unmount")}}),[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"fx-wrapper"},c.a.createElement("span",null,m),c.a.createElement("span",{onClick:function(){return null}},"X"),c.a.createElement(Y,null,c.a.createElement("div",null,c.a.createElement("h4",null,"Bits"),c.a.createElement(g,{numTicks:8,degrees:220,min:0,max:8,value:n.bits,size:35,onChange:function(e){return function(e){r((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(o.a)({},m,{bits:e}))})),t[m].bits=8-f.current.bits}(e)}})))))},G=function(){var e=Object(a.useState)({}),t=Object(s.a)(e,2),n=t[0],r=t[1],u=Object(a.useState)({}),i=Object(s.a)(u,2),m=i[0],f=i[1],b=Object(a.useState)(!1),j=Object(s.a)(b,2),d=j[0],O=j[1];return Object(a.useEffect)((function(){r(M),f((function(){var e={};return Object.keys(M).map((function(t){e=Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t,Object(l.a)({},M[t].params)))})),e}))}),[]),Object(a.useEffect)((function(){console.log(m)}),[m]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"fx-button",onClick:function(){return O((function(e){return!e}))}},"Effects"),d&&Object.keys(n).length>0&&c.a.createElement("div",{className:"fx-collector-window"},Object.keys(n).map((function(e){return"delay"===e?c.a.createElement(P,{key:e,setParams:f,params:Object(l.a)({},m[e]),FX:Object(o.a)({},e,n[e].tone)},e):"phaser"===e?c.a.createElement(V,{key:e,setParams:f,params:Object(l.a)({},m[e]),FX:Object(o.a)({},e,n[e].tone)},e):"bitCrusher"===e?c.a.createElement($,{key:e,setParams:f,params:Object(l.a)({},m[e]),FX:Object(o.a)({},e,n[e].tone)},e):void 0}))))},H=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],K=function(){var e={};return Object.keys(z).map((function(t){e=Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t,H))})),e},Q=function(){var e=Object(a.useState)(K),t=Object(s.a)(e,2),n=t[0],r=t[1],u=Object(a.useState)(-1),i=Object(s.a)(u,2),f=i[0],b=i[1],j=Object(a.useState)({}),d=Object(s.a)(j,2),O=d[0],v=d[1],p=Object(a.useState)(!1),g=Object(s.a)(p,2),E=g[0],h=g[1],k=Object(a.useState)("kick"),w=Object(s.a)(k,2),S=w[0],N=w[1],x=Object(a.useState)(120),T=Object(s.a)(x,2),D=T[0],C=T[1],M=Object(a.useState)(30),F=Object(s.a)(M,2),R=F[0],q=F[1],X=Object(a.useRef)(O);X.current=O;var I=Object(a.useRef)(n);I.current=n;var P=Object(a.useRef)(f);P.current=f,Object(a.useEffect)((function(){m.a.Transport.scheduleRepeat((function(e){b((function(e){return e<15?e+=1:0})),Object.keys(X.current).map((function(t){I.current[t][P.current]&&X.current[t].start(e)}))}),"16n");new m.a.Limiter(-40).toMaster();q(-40+R)}),[]);return Object(a.useEffect)((function(){E?m.a.Transport.start():m.a.Transport.stop()}),[E]),Object(a.useEffect)((function(){m.a.Transport.bpm.value=D}),[D]),Object(a.useEffect)((function(){m.a.Master.volume.value=R}),[R]),Object(a.useEffect)((function(){})),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"main-body"},c.a.createElement(A,{samples:z,setBuffers:v,toggleInstrument:function(e){N(e)},currentInstrument:S}),c.a.createElement("div",{className:"master"},c.a.createElement("h3",null,"Master"),c.a.createElement(y,{setPlayStop:function(){return h((function(e){return!e}))},playStop:E,setBpm:C,bpm:D,volume:R,minVolume:-40,setVolume:q}),c.a.createElement(G,null))),c.a.createElement("div",{className:"steps-sequencer"},c.a.createElement("div",{className:"step-container"},c.a.createElement(B,{currentStep:f,steps:n[S],name:S,toggleStep:function(e){return function(e){r((function(t){return Object(l.a)(Object(l.a)({},n),{},Object(o.a)({},S,n[S].map((function(t,n){return n===e?!t:t}))))}))}(e)}}))))};var U=function(){var e=Object(a.useState)(["App"]),t=Object(s.a)(e,2),n=t[0],r=(t[1],Object(a.useState)("")),u=Object(s.a)(r,2);return u[0],u[1],c.a.createElement("div",{className:n.join(" ")},c.a.createElement(Q,null),c.a.createElement("p",null,"Drum Machine made with ",c.a.createElement("strong",null,"Tonejs")," and ",c.a.createElement("strong",null,"React")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.4e67cd6f.chunk.js.map